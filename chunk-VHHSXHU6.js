
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="5bc76d96-9050-579a-87ed-8d97976a44bc")}catch(e){}}();
import{a as Ee}from"./chunk-C2GV5OS6.js";import{i as Ce,j as De}from"./chunk-LTXWHCUV.js";import{a as Se,b as J,c as we,d as Me,e as Ne,f as P,g as Pe,h as ke,j as Ie,k as Oe,o as Te}from"./chunk-U5JLPOF6.js";import{a as G,b as l,c as D,d as xe}from"./chunk-Z227VDA2.js";import{a as Fe}from"./chunk-4XP7D6MF.js";import{$a as he,Aa as X,B as R,Ba as $,Ca as L,Da as H,F as g,Fa as ge,Ha as fe,I as W,Ia as C,J as Q,Ja as z,Ka as j,La as be,N as de,O as T,P as E,T as le,Ua as U,Za as q,_ as i,_a as ve,a as oe,aa as f,ab as ye,b as re,ba as w,bb as B,fa as b,h as K,i as k,ib as _e,ja as x,k as O,ka as F,l as ie,la as pe,m as Y,ma as v,n as ae,na as V,o as se,oa as ue,pa as y,qa as _,ra as s,sa as a,t as me,ta as u,ua as A,va as M,wa as m,xa as c,ya as I,z as ce,za as N}from"./chunk-XZX3LLVG.js";var p=[];for(let e=0;e<256;++e)p.push((e+256).toString(16).slice(1));function Ae(e,o=0){return(p[e[o+0]]+p[e[o+1]]+p[e[o+2]]+p[e[o+3]]+"-"+p[e[o+4]]+p[e[o+5]]+"-"+p[e[o+6]]+p[e[o+7]]+"-"+p[e[o+8]]+p[e[o+9]]+"-"+p[e[o+10]]+p[e[o+11]]+p[e[o+12]]+p[e[o+13]]+p[e[o+14]]+p[e[o+15]]).toLowerCase()}var Z,Qe=new Uint8Array(16);function ee(){if(!Z){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Z=crypto.getRandomValues.bind(crypto)}return Z(Qe)}var Xe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),te={randomUUID:Xe};function Je(e,o,t){if(te.randomUUID&&!o&&!e)return te.randomUUID();e=e||{};let n=e.random??e.rng?.()??ee();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,o){if(t=t||0,t<0||t+16>o.length)throw new RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let r=0;r<16;++r)o[t+r]=n[r];return o}return Ae(n)}var ne=Je;var je=(()=>{class e{http;donationAmountsSubject=new k(l());donationAmounts$=this.donationAmountsSubject.asObservable();displayNamesSubject=new k(l());displayNames$=this.displayNamesSubject.asObservable();displayNames=["Anonymous Hero","Secret Admirer","Mystery Donor","Silent Supporter","Kind Stranger","Generous Soul","Loyal Fan","True Believer","Dream Maker","Star Gazer"];messages=["Keep up the amazing work!","You're doing great!","Love your content!","Thanks for the entertainment!","You deserve this!","Keep shining!","You're awesome!","Much love and support!","Keep being amazing!","You're the best!"];constructor(t){this.http=t}getRandomDisplayName(){return Y(this.http.get("https://randomuser.me/api/")).then(t=>{let n=t?.results?.[0]?.name;return n?n.first+" "+n.last:this.getRandomDisplayNameLocal()},()=>this.getRandomDisplayNameLocal())}getRandomDisplayNames(){Y(this.http.get("https://randomuser.me/api/?results=14")).then(t=>{let n=t?.results?.map(r=>!r||!r.name?{name:"unknown"}:{name:r.name.first+" "+r.name.last});n||this.displayNamesSubject.next(G()),this.displayNamesSubject.next(D(n))})}getRandomMessage(){return Y(this.http.get("https://api.quotable.io/random")).then(t=>({message:t?.content||this.getRandomMessageLocal(),author:t?.author||"Anonymous"}),()=>({message:this.getRandomMessageLocal(),author:"Anonymous"}))}getRandomDisplayNameLocal(){let t=Math.floor(Math.random()*this.displayNames.length);return this.displayNames[t]}getRandomMessageLocal(){let t=Math.floor(Math.random()*this.messages.length);return this.messages[t]}getRecommendedDonationAmount(){this.donationAmountsSubject.next(D([{amount:8e3},{amount:1e4},{amount:15e3},{amount:2e4},{amount:5e4},{amount:1e5}]))}static \u0275fac=function(n){return new(n||e)(W(U))};static \u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function nt(e,o){e&1&&(s(0,"div",6),c(1,"Amount is required and must be greater than 0"),a())}function ot(e,o){if(e&1&&(s(0,"div",6),c(1),a()),e&2){let t=m();i(),I(t.error)}}function rt(e,o){if(e&1){let t=A();s(0,"button",15),M("click",function(){let r=T(t).$implicit,d=m(2);return E(d.useRecommendedAmount(r))}),c(1),C(2,"currency"),a()}if(e&2){let t=o.$implicit,n=m(2);x("disabled",n.loadingDisplayName),i(),N(" ",j(2,2,t.amount,"VND")," ")}}function it(e,o){if(e&1&&y(0,rt,3,5,"button",14,V),e&2){m();let t=H(12);_(t==null?null:t.data)}}function at(e,o){e&1&&u(0,"div",16)}function st(e,o){if(e&1&&y(0,at,1,0,"div",16,V),e&2){let t=m();_(t.Array(4))}}function mt(e,o){if(e&1){let t=A();s(0,"button",15),M("click",function(){let r=T(t).$implicit,d=m(2);return E(d.useRecommendedDisplayName(r))}),c(1),a()}if(e&2){let t=o.$implicit,n=m(2);x("disabled",n.loadingDisplayName),i(),N(" ",t.name," ")}}function ct(e,o){if(e&1&&y(0,mt,2,2,"button",14,V),e&2){m();let t=H(21);_(t==null?null:t.data)}}function dt(e,o){e&1&&u(0,"div",16)}function lt(e,o){if(e&1&&y(0,dt,1,0,"div",16,V),e&2){let t=m();_(t.Array(4))}}function pt(e,o){if(e&1&&(s(0,"button",13),c(1),a()),e&2){let t=m();i(),N(" Donate ",t.submit.isNoticeSuccess?"\u{1F44D}":""," ")}}function ut(e,o){e&1&&u(0,"input",17)}function gt(e,o){e&1&&u(0,"input",18)}function ft(e,o){if(e&1&&b(0,ut,1,0,"input",17)(1,gt,1,0,"input",18),e&2){let t=m();v(t.donateForm.invalid?0:1)}}var Ue=(()=>{class e{recommendationService;keycloakProfile=l();streamer=l();minAmount=l();donate=new le;error=null;submit=D({});donateForm;loadingDisplayName=!1;loadingMessage=!1;Array=Array;destroy$=new K;constructor(t){this.recommendationService=t,this.donateForm=new Ne({streamerId:new P(""),streamerName:new P(""),amount:new P("",[J.required,J.min(1)]),displayName:new P(""),message:new P(""),idempotentKey:new P(ne()),submit:new P("Donate \u{1F680}")})}get amount(){return this.donateForm.get("amount")}get streamerName(){return this.donateForm.get("streamerName")}ngOnInit(){this.suggestDisplayName(),this.suggestMessage(),this.recommendationService.getRandomDisplayNames(),this.recommendationService.getRecommendedDonationAmount()}ngOnChanges(){if(this.streamer.data&&this.donateForm.patchValue({streamerId:this.streamer.data.id,streamerName:this.streamer.data.nickname}),this.minAmount.data){let t=this.donateForm.get("amount");t&&t.value<this.minAmount.data.amount&&this.donateForm.patchValue({amount:this.minAmount.data.amount})}}onSubmit(){if(this.donateForm.invalid)return;let t=this.donateForm.value,n=re(oe({},t),{submitAt:this.getCurrentDate(),displayName:this.isNullOrEmptyOrBlank(t.displayName)?"Anonymous":t.displayName});this.donate.emit(n)}suggestDisplayName(){this.recommendationService.getRandomDisplayName().then(t=>{this.donateForm.patchValue({displayName:t})})}suggestMessage(){this.loadingMessage=!0,this.recommendationService.getRandomMessage().then(t=>{this.donateForm.patchValue({message:t.message})}).finally(()=>{this.loadingMessage=!1})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}useRecommendedDisplayName(t){this.donateForm.patchValue({displayName:t.name})}useRecommendedAmount(t){this.donateForm.patchValue({amount:t.amount})}isNullOrEmptyOrBlank(t){return t==null?!0:t.trim()===""}getCurrentDate(){let t=new Date,n=navigator.language;return new Intl.DateTimeFormat(n,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}).format(t)}static \u0275fac=function(n){return new(n||e)(f(je))};static \u0275cmp=w({type:e,selectors:[["app-donate-form"]],inputs:{keycloakProfile:"keycloakProfile",streamer:"streamer",minAmount:"minAmount",error:"error",submit:"submit"},outputs:{donate:"donate"},features:[de],decls:33,vars:18,consts:[[1,"donate-form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","streamerName"],["type","text","id","streamerName","formControlName","streamerName","readonly","",1,"form-control"],["for","amount"],["type","number","inputmode","numeric","id","amount","formControlName","amount","placeholder","Enter amount","step","1000",1,"form-control"],[1,"error-message"],[1,"list-horizon"],["for","displayName"],["type","text","id","displayName","formControlName","displayName","placeholder","Enter display name",1,"form-control"],["for","message"],["id","message","formControlName","message","placeholder","Type a message...",1,"form-control"],[1,"form-actions"],["type","button","disabled","",1,"submit-button","skeleton"],["type","button","title","Get random name",1,"suggest-button","gradient-border",3,"disabled"],["type","button","title","Get random name",1,"suggest-button","gradient-border",3,"click","disabled"],[1,"suggest-button","skeleton",2,"height","16px","width","32px"],["type","submit","disabled","","value","Donate",1,"submit-button"],["type","submit","formControlName","submit","value","Donate \u{1F680}",1,"submit-button"]],template:function(n,r){if(n&1){let d=A();s(0,"form",0),M("ngSubmit",function(){return T(d),E(r.onSubmit())}),s(1,"div",1)(2,"label",2),c(3,"Streamer"),a(),u(4,"input",3),a(),s(5,"div",1)(6,"label",4),c(7,"Amount"),a(),u(8,"input",5),b(9,nt,2,0,"div",6)(10,ot,2,1,"div",6),s(11,"div",7),$(12),C(13,"async"),b(14,it,2,0)(15,st,2,0),a()(),s(16,"div",1)(17,"label",8),c(18,"Display Name"),a(),u(19,"input",9),s(20,"div",7),$(21),C(22,"async"),b(23,ct,2,0)(24,lt,2,0),a()(),s(25,"div",1)(26,"label",10),c(27,"Message"),a(),s(28,"textarea",11),c(29,"            "),a()(),s(30,"div",12),b(31,pt,2,1,"button",13)(32,ft,2,1),a()()}if(n&2){x("formGroup",r.donateForm),i(4),F("skeleton",!(r.streamerName!=null&&r.streamerName.value)),i(5),v(r.amount!=null&&r.amount.invalid&&r.amount?9:-1),i(),v(r.error?10:-1),i(2);let d=L(z(13,12,r.recommendationService.donationAmounts$));i(2),v(d!=null&&d.data?14:d!=null&&d.isPending?15:-1),i(5),F("skeleton",r.loadingDisplayName),i(2);let h=L(z(22,15,r.recommendationService.displayNames$));i(2),v(h!=null&&h.data?23:h!=null&&h.isPending?24:-1),i(5),F("skeleton",r.loadingMessage),i(3),v(r.keycloakProfile.isPending||r.submit.isPending||r.minAmount.isPending||r.streamer.isPending?31:32)}},dependencies:[Te,Pe,Se,ke,we,Me,Ie,Oe,B,q,ye],styles:[`h2[_ngcontent-%COMP%]{margin:0 0 1.5rem;font-size:1.3rem;color:var(--text-primary)}.donate-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.list-horizon[_ngcontent-%COMP%]{display:flex;flex-direction:row;overflow-x:auto;gap:8px;margin-top:8px;padding-bottom:4px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.7rem;color:var(--text-secondary);font-weight:500;transform:translateY(-12px) translate(8px);background-color:var(--bg-primary);padding:4px;border-radius:8px;width:fit-content;position:absolute}.form-control[_ngcontent-%COMP%]{padding:.75rem;border:1px solid var(--border-color);border-radius:8px;font-size:1rem;transition:border-color .2s,box-shadow .2s;background-color:var(--bg-primary);color:var(--text-primary)}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary)}.form-control[readonly][_ngcontent-%COMP%]{background-color:var(--bg-secondary);cursor:not-allowed}textarea.form-control[_ngcontent-%COMP%]{min-height:100px;resize:vertical}.error-message[_ngcontent-%COMP%]{color:var(--error);font-size:.85rem;margin-top:.25rem}.form-actions[_ngcontent-%COMP%]{margin-top:1rem}.submit-button[_ngcontent-%COMP%]{width:100%;padding:.75rem 1.5rem;background-color:var(--success);color:#fff;border:none;border-radius:6px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .2s ease;text-transform:uppercase;letter-spacing:.5px;box-shadow:var(--shadow-sm);display:flex;align-items:center;justify-content:center;gap:.5rem}.submit-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--success-dark);transform:translateY(-1px);box-shadow:var(--shadow-md)}.submit-button[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0);box-shadow:var(--shadow-sm)}.submit-button[_ngcontent-%COMP%]:disabled{background-color:var(--bg-hover);color:var(--text-muted);cursor:not-allowed;box-shadow:none}.submit-button.skeleton[_ngcontent-%COMP%]{background-color:var(--bg-hover);color:transparent;-webkit-user-select:none;user-select:none;pointer-events:none;box-shadow:none}@media (max-width: 640px){.submit-button[_ngcontent-%COMP%]{padding:.6rem 1.2rem;font-size:.95rem}}.form-control.skeleton[_ngcontent-%COMP%]{background-color:var(--bg-hover);color:transparent;-webkit-user-select:none;user-select:none;pointer-events:none}.suggest-button[_ngcontent-%COMP%]{padding:8px;color:var(--text-primary);background-color:var(--bg-secondary);font-size:.7rem;border:1px solid var(--border-color);border-radius:8px;cursor:pointer;transition:all .2s ease;white-space:nowrap}.gradient-border[_ngcontent-%COMP%]{border:1px solid transparent;border-radius:8px;background:linear-gradient(to right,var(--bg-secondary),var(--bg-secondary)),linear-gradient(to right,#833ab4,#fd1d1d,#fcb045);background-clip:padding-box,border-box;background-origin:padding-box,border-box}.suggest-button[_ngcontent-%COMP%]:hover{background-color:var(--bg-hover);border-color:var(--primary)}.suggest-button[_ngcontent-%COMP%]:active{transform:scale(.95)}textarea.form-control[_ngcontent-%COMP%]{flex:1}@media (max-width: 480px){.suggest-button[_ngcontent-%COMP%]{font-size:.6rem}}
/*# sourceMappingURL=donate-form.component-KCRRVG27.css.map */`]})}return e})();var bt=()=>[1,2,3],vt=(e,o)=>o.id;function ht(e,o){e&1&&(s(0,"div",5),u(1,"div",6)(2,"div",7)(3,"div",8),a())}function yt(e,o){e&1&&(s(0,"div",2),y(1,ht,4,0,"div",5,ue),a()),e&2&&(i(),_(ge(0,bt)))}function _t(e,o){if(e&1&&(s(0,"div",3)(1,"p"),c(2),a()()),e&2){let t=m(2);i(2),I(t.emptyMessage)}}function xt(e,o){if(e&1&&(s(0,"div",13),c(1),a()),e&2){let t=m().$implicit;i(),I(t.message)}}function Ct(e,o){if(e&1&&(s(0,"div",9)(1,"div",10)(2,"span",11),c(3),C(4,"number"),a(),s(5,"span",12),c(6),a()(),b(7,xt,2,1,"div",13),s(8,"div",14)(9,"span",15),c(10),C(11,"date"),a(),s(12,"span",16),c(13),C(14,"number"),a()()()),e&2){let t=o.$implicit;i(3),X(" ",j(4,9,t.amount,"1.0-0")," ",t.currency," "),i(2),pe(t.status.toLowerCase()),i(),N(" ",t.status," "),i(),v(t.message?7:-1),i(3),I(j(11,12,t.createdAt,"medium")),i(3),X(" Balance: ",j(14,15,t.balanceAfter,"1.0-0")," ",t.currency," ")}}function Dt(e,o){if(e&1&&(s(0,"div",4),y(1,Ct,15,18,"div",9,vt),a()),e&2){m();let t=H(3);i(),_(t==null?null:t.data)}}function St(e,o){if(e&1&&(s(0,"div",1)(1,"h3"),c(2),a(),$(3),C(4,"async"),b(5,yt,3,1,"div",2)(6,_t,3,1,"div",3)(7,Dt,3,0,"div",4),a()),e&2){let t=m();i(2),I(t.title),i();let n=L(z(4,2,t.service.getDonations()));i(2),v(n!=null&&n.isPending?5:(n==null||n.data==null?null:n.data.length)===0?6:7)}}var Be=(()=>{class e{title="";service;emptyMessage="No donations yet.";static \u0275fac=function(n){return new(n||e)};static \u0275cmp=w({type:e,selectors:[["app-donation-tab-item"]],inputs:{title:"title",service:"service",emptyMessage:"emptyMessage"},decls:2,vars:0,consts:[["tabItem",""],[1,"donation-tab-content"],[1,"loading-skeleton"],[1,"no-donations"],[1,"donation-list"],[1,"skeleton-item"],[1,"skeleton-header"],[1,"skeleton-message"],[1,"skeleton-footer"],[1,"donation-item"],[1,"donation-header"],[1,"donation-amount"],[1,"donation-status"],[1,"donation-message"],[1,"donation-footer"],[1,"donation-time"],[1,"donation-balance"]],template:function(n,r){n&1&&b(0,St,8,5,"ng-template",null,0,be)},dependencies:[B,q,he,ve],styles:[`h3[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.1rem;color:var(--text-primary)}.donation-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.donation-item[_ngcontent-%COMP%]{background:var(--bg-secondary);border-radius:8px;padding:1rem;border:1px solid var(--border-color)}.donation-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}.donation-amount[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:var(--success)}.donation-status[_ngcontent-%COMP%]{font-size:.85rem;padding:.25rem .5rem;border-radius:4px;font-weight:500}.donation-status.completed[_ngcontent-%COMP%]{background-color:var(--success-bg);color:var(--success)}.donation-status.initialized[_ngcontent-%COMP%]{background-color:var(--warning-bg);color:var(--warning)}.donation-message[_ngcontent-%COMP%]{margin:.5rem 0;color:var(--text-secondary);font-style:italic}.donation-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-size:.85rem;color:var(--text-muted);margin-top:.5rem}.loading-skeleton[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.skeleton-item[_ngcontent-%COMP%]{background:var(--bg-secondary);border-radius:8px;padding:1rem;border:1px solid var(--border-color)}.skeleton-header[_ngcontent-%COMP%]{height:20px;background:var(--bg-hover);border-radius:4px;margin-bottom:.5rem}.skeleton-message[_ngcontent-%COMP%]{height:16px;background:var(--bg-hover);border-radius:4px;margin-bottom:.5rem;width:70%}.skeleton-footer[_ngcontent-%COMP%]{height:14px;background:var(--bg-hover);border-radius:4px;width:50%}.no-donations[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:var(--text-muted)}
/*# sourceMappingURL=donation-tab-item.component-HBNW3QKF.css.map */`]})}return e})();var Re=(e,o)=>o.getTitle();function wt(e,o){if(e&1){let t=A();s(0,"button",4),M("click",function(){let r=T(t).$implicit,d=m();return E(d.setActiveTab(r.getTitle()))}),c(1),a()}if(e&2){let t=o.$implicit,n=m();F("active",n.activeTab===t.getTitle()),i(),N(" ",t.getTitle()," ")}}function Mt(e,o){if(e&1&&(s(0,"div",5),u(1,"app-donation-tab-item",6),a()),e&2){let t=m().$implicit;i(),x("service",t)}}function Nt(e,o){if(e&1&&b(0,Mt,2,1,"div",5),e&2){let t=o.$implicit,n=m();v(n.activeTab===t.getTitle()?0:-1)}}var Ve=(()=>{class e{services=[];activeTab="";ngAfterContentInit(){this.services.length>0&&(this.activeTab=this.services[0].getTitle())}setActiveTab(t){this.activeTab=t}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=w({type:e,selectors:[["app-donation-tabs"]],inputs:{services:"services"},decls:7,vars:0,consts:[[1,"tabs-container"],[1,"tabs-header"],[1,"tab-button",3,"active"],[1,"tab-content"],[1,"tab-button",3,"click"],[1,"tab-panel"],[3,"service"]],template:function(n,r){n&1&&(s(0,"div",0)(1,"div",1),y(2,wt,2,3,"button",2,Re),a(),s(4,"div",3),y(5,Nt,1,1,null,null,Re),a()()),n&2&&(i(2),_(r.services),i(3),_(r.services))},dependencies:[B,Be],styles:[`.tabs-container[_ngcontent-%COMP%]{width:100%}.tabs-header[_ngcontent-%COMP%]{display:flex;border-bottom:1px solid var(--border-color);margin-bottom:1.5rem}.tab-button[_ngcontent-%COMP%]{background:none;border:none;padding:.75rem 1.5rem;cursor:pointer;font-size:.9rem;color:var(--text-secondary);border-bottom:2px solid transparent;transition:all .2s}.tab-button[_ngcontent-%COMP%]:hover{color:var(--text-primary);background:var(--bg-hover)}.tab-button.active[_ngcontent-%COMP%]{color:var(--primary);border-bottom-color:var(--primary);font-weight:500}.tab-content[_ngcontent-%COMP%]{min-height:200px}.tab-panel[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .2s ease-in}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@media (max-width: 640px){.tabs-header[_ngcontent-%COMP%]{flex-direction:column;border-bottom:none;border-right:1px solid var(--border-color);margin-bottom:1rem;margin-right:1rem}.tab-button[_ngcontent-%COMP%]{border-bottom:none;border-right:2px solid transparent;text-align:left}.tab-button.active[_ngcontent-%COMP%]{border-right-color:var(--primary)}}
/*# sourceMappingURL=donation-tabs.component-2CNBWBGH.css.map */`]})}return e})();var $e=(()=>{class e{getErrorMessage(t){if(t.error instanceof ErrorEvent)return"An error occurred. Please try again later.";let n=t.error;return n?.message?n.message:"An unexpected error occurred. Please try again later."}getErrorCode(t){return t.error?.code||"UNKNOWN_ERROR"}getErrorDetails(t){return t.error?.details}static \u0275fac=function(n){return new(n||e)};static \u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Le=(()=>{class e{httpClient=Q(U);errorService=Q($e);constructor(){}donate(t){return this.httpClient.post("/api/v1/donation",t).pipe(me(n=>{let r=this.errorService.getErrorMessage(n),d=this.errorService.getErrorCode(n),h=this.errorService.getErrorDetails(n);return ie(()=>({message:r,code:d,details:h}))}))}static \u0275fac=function(n){return new(n||e)};static \u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var He=(()=>{class e{constructor(){}getMinimumDonateAmount(t){return O({amount:8e3})}static \u0275fac=function(n){return new(n||e)};static \u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var hn=[{id:"1",streamerUsername:"cuongbaynui",streamerName:"C\u01B0\u1EDDng B\u1EA3y N\xFAi",amount:5e5,currency:"VND",balanceBefore:1e6,balanceAfter:5e5,status:"COMPLETED",message:"C\u1EA3m \u01A1n anh C\u01B0\u1EDDng, em r\u1EA5t th\xEDch c\xE1c video c\u1EE7a anh!",createdAt:new Date().toISOString()},{id:"2",streamerUsername:"cuongbaynui",streamerName:"C\u01B0\u1EDDng B\u1EA3y N\xFAi",amount:1e6,currency:"VND",balanceBefore:2e6,balanceAfter:1e6,status:"PENDING",message:"Ch\xFAc anh C\u01B0\u1EDDng lu\xF4n vui v\u1EBB v\xE0 th\xE0nh c\xF4ng!",createdAt:new Date(Date.now()-36e5).toISOString()},{id:"3",streamerUsername:"cuongbaynui",streamerName:"C\u01B0\u1EDDng B\u1EA3y N\xFAi",amount:2e6,currency:"VND",balanceBefore:3e6,balanceAfter:1e6,status:"FAILED",message:"\u1EE6ng h\u1ED9 anh C\u01B0\u1EDDng ti\u1EBFp t\u1EE5c s\xE1ng t\u1EA1o n\u1ED9i dung hay!",createdAt:new Date(Date.now()-72e5).toISOString()},{id:"4",streamerUsername:"cuongbaynui",streamerName:"C\u01B0\u1EDDng B\u1EA3y N\xFAi",amount:15e5,currency:"VND",balanceBefore:25e5,balanceAfter:1e6,status:"REFUNDED",message:null,createdAt:new Date(Date.now()-108e5).toISOString()},{id:"5",streamerUsername:"cuongbaynui",streamerName:"C\u01B0\u1EDDng B\u1EA3y N\xFAi",amount:3e6,currency:"VND",balanceBefore:4e6,balanceAfter:1e6,status:"COMPLETED",message:"Anh C\u01B0\u1EDDng l\xE0 ngu\u1ED3n c\u1EA3m h\u1EE9ng tuy\u1EC7t v\u1EDDi!",createdAt:new Date(Date.now()-144e5).toISOString()},{id:"6",streamerUsername:"cuongbaynui",streamerName:"C\u01B0\u1EDDng B\u1EA3y N\xFAi",amount:5e4,currency:"USD",balanceBefore:1e5,balanceAfter:5e4,status:"COMPLETED",message:"Thank you for your amazing content! Keep up the good work!",createdAt:new Date(Date.now()-18e6).toISOString()},{id:"7",streamerUsername:"cuongbaynui",streamerName:"C\u01B0\u1EDDng B\u1EA3y N\xFAi",amount:1e6,currency:"VND",balanceBefore:2e6,balanceAfter:1e6,status:"COMPLETED",message:"Anh C\u01B0\u1EDDng \u01A1i, em r\u1EA5t th\xEDch c\xE1ch anh chia s\u1EBB v\u1EC1 cu\u1ED9c s\u1ED1ng \u1EDF v\xF9ng n\xFAi. Nh\u1EEFng c\xE2u chuy\u1EC7n c\u1EE7a anh th\u1EADt th\xFA v\u1ECB v\xE0 \xFD ngh\u0129a. Em mong anh s\u1EBD ti\u1EBFp t\u1EE5c l\xE0m nhi\u1EC1u video hay nh\u01B0 v\u1EADy n\u1EEFa!",createdAt:new Date(Date.now()-216e5).toISOString()},{id:"8",streamerUsername:"cuongbaynui",streamerName:"C\u01B0\u1EDDng B\u1EA3y N\xFAi",amount:2e6,currency:"VND",balanceBefore:3e6,balanceAfter:1e6,status:"PENDING",message:null,createdAt:new Date(Date.now()-252e5).toISOString()}],ze=(()=>{class e{http;donationHistorySubject=new k(l());donationHistory$=this.donationHistorySubject.asObservable();streamerUsername="";constructor(t){this.http=t}getDonationHistory(){return this.http.get(`/api/v1/streamers/${this.streamerUsername}/donations`).pipe(xe(this.donationHistorySubject))}getDonations(){return this.donationHistory$}getTitle(){return"Streamer donate history"}static \u0275fac=function(n){return new(n||e)(W(U))};static \u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Ge=(()=>{class e{donationHistorySubject=new k(l());donationHistory$=this.donationHistorySubject.asObservable();getDonationHistory(){return console.log("Getting user donations for streamer:"),O(l())}getDonations(){return this.donationHistory$}getTitle(){return"User Donation History"}static \u0275fac=function(n){return new(n||e)};static \u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Tt=(e,o)=>[e,o],On=(()=>{class e{walletService;donateService;paymentService;streamerService;streamerDonationHistoryService;userDonationHistoryService;route;logger;authSession;streamer=l();minAmount=l();donationError=null;keycloakProfile=l();submit=D({});destroy$=new K;constructor(t,n,r,d,h,Ke,Ye,We,qe){this.walletService=t,this.donateService=n,this.paymentService=r,this.streamerService=d,this.streamerDonationHistoryService=h,this.userDonationHistoryService=Ke,this.route=Ye,this.logger=We,this.authSession=qe}ngOnInit(){this.route.paramMap.pipe(R(this.destroy$)).subscribe(t=>{let n=t.get("streamerUsername");if(!n||n.trim()===""){this.logger.err("Invalid streamerId"),this.streamer=G({reason:"Invalid streamer username"});return}this.streamerDonationHistoryService.streamerUsername=n,this.paymentService.getMinimumDonateAmount({streamerId:n}).pipe(R(this.destroy$)).subscribe(r=>this.minAmount=D(r)),this.streamerDonationHistoryService.getDonationHistory().subscribe(),this.streamerService.getStreamer({id:n}).pipe(R(this.destroy$)).subscribe(r=>this.streamer=r)}),this.route.paramMap.pipe(R(this.destroy$),ae(t=>t.get("streamerUsername")),se(t=>t?this.streamerService.getStreamer({id:t}):O(G({reason:`url username: ${t}`})))).subscribe(t=>this.streamer=t),this.authSession.userProfile$.subscribe(t=>{this.keycloakProfile=t})}onDonate(t){this.donationError=null,this.submit=l(),this.donateService.donate(t).pipe(ce(()=>{this.walletService.refreshBalance()})).subscribe({next:n=>{this.onDonateSuccess({formData:t,resp:n}),this.submit=D({})},error:n=>{switch(n.code){case"INSUFFICIENT_BALANCE":this.donationError="Insufficient balance to complete this donation. Please top up your wallet.";break;case"WALLET_NOT_FOUND":this.donationError="Unable to find your wallet. Please contact support if this persists.";break;case"STREAMER_NOT_FOUND":this.donationError="The streamer you're trying to donate to could not be found.";break;default:this.donationError=n.message||"An unexpected error occurred. Please try again later."}}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onDonateSuccess(t){this.logger.debug("success"),this.donationError=null,this.streamer.data&&this.streamerDonationHistoryService.getDonationHistory().subscribe()}static \u0275fac=function(n){return new(n||e)(f(De),f(Le),f(He),f(Ee),f(ze),f(Ge),f(_e),f(Fe),f(Ce))};static \u0275cmp=w({type:e,selectors:[["app-streamer"]],decls:6,vars:9,consts:[[1,"streamer-container"],[1,"streamer-card"],[1,"donate-section"],[3,"donate","keycloakProfile","streamer","minAmount","error","submit"],[1,"history-section"],[3,"services"]],template:function(n,r){n&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-donate-form",3),M("donate",function(h){return r.onDonate(h)}),a()(),s(4,"div",4),u(5,"app-donation-tabs",5),a()()()),n&2&&(i(3),x("keycloakProfile",r.keycloakProfile)("streamer",r.streamer)("minAmount",r.minAmount)("error",r.donationError)("submit",r.submit),i(2),x("services",fe(6,Tt,r.streamerDonationHistoryService,r.userDonationHistoryService)))},dependencies:[Ue,Ve],styles:[`.donate-section[_ngcontent-%COMP%]{margin-bottom:2rem}.history-section[_ngcontent-%COMP%]{margin-top:2rem;padding-top:1.5rem;border-top:1px solid var(--border-color)}.streamer-container[_ngcontent-%COMP%]{padding:2rem;max-width:800px;margin:0 auto}.streamer-card[_ngcontent-%COMP%]{background:var(--bg-primary);border-radius:16px;box-shadow:var(--shadow-md);padding:2rem}@media (max-width: 640px){.streamer-container[_ngcontent-%COMP%]{padding:1rem}.streamer-card[_ngcontent-%COMP%]{padding:1.5rem}}
/*# sourceMappingURL=streamer.component-NFGFNKPO.css.map */`]})}return e})();export{On as StreamerComponent};
//# sourceMappingURL=chunk-VHHSXHU6.js.map

//# debugId=5bc76d96-9050-579a-87ed-8d97976a44bc
